# Модель прогнозирования температуры плавления стали
#### Описание исследования
Данное исследование предназначено для выявления наиболее подходящей модели машинного обучения, 
которая позволит предсказывать температуру сплава в производственном процессе на металлургическом комбинате "Стальная птица"
Были предоставлены 7 файлов с табицами данных:  
1. data_arc_new.csv — данные об электродах;   
2. data_bulk_new.csv — данные о подаче сыпучих материалов (объём);    
3. data_bulk_time_new.csv — данные о подаче сыпучих материалов (время);  
4. data_gas_new.csv — данные о продувке сплава газом;  
5. data_temp_new.csv — результаты измерения температуры;  
6. data_wire_new.csv — данные о проволочных материалах (объём);  
7. data_wire_time_new.csv — данные о проволочных материалах (время).  
Все таблицы имеют столбец с ключом, его численнное выражение отражает номер партии.
### План работы  
1 Загрузка данных   
2 Обзор таблицы с данными  
3 Предобработка данных  
4 Объединение данных    
5 Статистический анализ объединенных данных    
6 Подготовка данных к обучению моделей прогнозирования   
7 Обучение моделей машинного обучения     
8 Тестирование лучшей модели  
9 Общий вывод и рекомендации заказчику  

#### Общие выводы
В ходе исследования мной были предприняты следующие действия:    
1 Загрузка данных     
Семь таблиц с инфорацией о производстве стали содержат корректные данные, соответствующие описанию файлов.  
Таблицы содержат показатели, описывающее производство  3239 партий стали.  
Были произведены изменения в названиях столбцов и унификация их написания для удобной работы с данными:   
приведение к нижнему регистру и перевод на английский  
2 Обзор таблицы с данными    
На данном этапе был проведён обзор данных и совершены следующией действия:        
    1) Пропуски в численных параметрах были заполнены нулями      
    2) Были заменены типы данных из object на соответствующие фактическим: float и datetime64   
    3) Были замечены аномалии и выбросы, обработанные на будущих этапах
    
3 Предобработка данных  
На данном этапе были произведены следующие действия:  
    1) Из данных были исключены записи, содержащие меньше двух замеров температуры нагрева    
    2) Убедились в корретности регистрации нагревания по времени - последний замер всегда идёт после первого замера.  
    3) Сопоставили время контрольного замера температуры со временем начала и конца нагрева  
    4) Собрали список ключей партий, прошедших по критериям отбора.  
    5) Из первоначальных 3216 партий к дальнейшему рассмотрению прошли 2473 партий. Количество партий сократилось на 23%  
4 Объединение данных   
Было произведено объединение таблиц, содержащих данные об электродах, объемах подачи сыпучих веществ, продувке сплава газом, 
проволочных материалах и замерах температуры.  
Данные были отобраны по ключам, которые были выявлены на предыдущем этапе работы.  
Был создан дополнительный признак - соотношения активной и реактивной мощностей, также вычислили среднее показателей мощностей.  
Пропуски в данных были заполнены нулями.  
Записи с отсутствующими показателями целевого признака - температуры сплава - в итоговую таблицу не попали.  
Итоговая таблица содержит 2327 записей о партиях стали, что на 28% меньше первоначального количества партий.    
  
5 Статистический анализ объединенных данных   
На данном этапе была рассмотрена матрица корреляции всех параметров, содержащихся в объединённой таблице.  
Были замечены параметры, имещие сильню корреляцию между собой(больше 0.90).  
Для избежания мультиколлинеарности, из таблицы были удалены следующие параметры:    
bulk_7, wire_4, bulk_2, wire_8, bulk_8, reactive_mean    
Также при рассмотрении статистики данных, были замечены значения, 
которые оценены как выбросы и аномалии (ниже 5% данных и выше 90% данных) в следующих столбцах:  
'power_ratio', 'active_mean', 'gas', 'start_temp'.  

6 Подготовка данных к обучению моделей прогнозирования   
На данном этапе данные были разделены на тренировочную и тестовую выборки в соотношении 3:1.  
В тренировочно выборке были исключены данные, содержащие аномалии и выбросы вне промежутка от 5% до 99% данных.  
Количество строк в тренировочной выборке сократилось с 1745 до 899.

7 Обучение моделей машинного обучения    
На данном этапе были обучены четыре модели машинного обучения:    
LinearRegression, RandomForestRegressor, CatBoostRegressor, LGBMRegressor.    
Только модель CatBoostRegressor справились с задачей добиться метрики ниже уровня 6,8.  
На тренировочной выборке лучший показатель продемонстрировала модель CatBoostRegressor со следующими гиперпарамтреами:      
'learning_rate': 0.1, 'loss_function': 'MAE', 'max_depth': 4, 'n_estimators': 250, 'random_state': 180324, 'verbose': False     
Эта модель показала минимальный из четырёх показатель MAE = 6,78.  
Также сопоставляя с MAE константной модели (8.05) видимо, что выявленная лучшая модель справляется с предсказаниями лучше.  

8 Тестирование лучшей модели  
Было проведено тестирование модели CatBoostRegressor со следующими гиперпарамтреами:        
'learning_rate': 0.1, 'loss_function': 'MAE', 'max_depth': 4, 'n_estimators': 250, 'random_state': 180324, 'verbose': False  
На тестовой выборке модель достигает показателя MAE = 6.55, что удовлетворяет минимальным требованиям.  
Были выявлены параметры, сильно влияющие на прогнозы модели (перечисление в порядке убывания):  
start_temp, bulk_14, bulk_12, wire_1, bulk_6, bulk_15, wire_2, wire_1, gas, power_ratio, active_mean    
Также было визуализировано соотношение предсказаний модели с целевым признаком тестовой выборки.  
По графику видно, что модель плохо предсказывает пиковые значения, тем не менее общие черты динамики температуры она отображает.    

9. Общий вывод  
Данные, предоставленный для обучения модели, имели много пропусков, выбросов и аномалий.    
Тем не менее, нам удалось на основе скромной выборки в 2327 записей, обучить модель, которая способна предсказывать температуру сплава.  
Есть возможности к улучшению работы модели: создание дополнительных признаков из уже существующих, обучение на новых корректно собранных данных.  
    
