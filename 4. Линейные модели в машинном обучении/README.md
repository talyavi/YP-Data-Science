# Разработка модели прогнозирования для молочного хозяйства «Вольный луг»  
#### Описание исследования
Данное исследование предназначено для выявления закономерностей среди различных факторов, влияющих на качество и количество производимого молока.  
Учёт таких закономерностей потенциально позволит построить модели для прогнозирования наиболее благоприятных путей развития преприятия.  

В данном случае владелец молочного хозяйства «Вольный луг» запросил разработку моделей, которые бы позволили принять объективное решение по закупке коров для фермерского хозяйства со следующими условиями:  
    Удой должен быть больше 6000 кг.  
    Молоко должно быть вкусным.  
    
Таким образом была поставлена задача построения линейной и логистической модели с помощью машинного обучения, которые могли бы очертить варианты к приобретению коров в соответствии сформулированным фермером требованиям.  
Для проведения исследования были предоставлены три таблицы сводных данных:    
    - Данные о стаде фермера на текущий момент.     
    - Данные, содержащие имя папы каждой коровы в стаде фермера.    
    - Данные о коровах «ЭкоФермы», которых фермер хочет изучить перед покупкой.     
В работе необходимо произвести следующие действия:    
1) Изучение общей информации:  
    - Изученеие файлов с данными, получение общей информации      
2) Предобработка данных:    
    - унификация написания названий столбцов и текстовой информации    
    - ликвидация пропусков и дублей    
    - изменение типов данных в соответствии с будущими вычислениями    
3) Исследовательский анализ:    
    - аналитика каждого параметра  
    - построение гистограмм и графиков "ящик с устами"    
    - выявление выбросов  
4) Корреляционный анализ данных:    
    - рассчёт коэффициенты корреляции между всеми признаками    
    - построение диаграмм рассеяния для признака "Удой, кг" и количественных признаков по выявленным породам    
    - определение качества связей между целевыми и входными признаками  
    - определение наличия нелинейности и мультиколлинеарности среди признаков.    
5) Построение трёх моделей линейной регрессии:    
    - выявление признаков, подходящих для построения модели  
    - построение первой модели  
    - построение второй модели с учётом нелинейности зависимости целевого и входящих признаков    
    - построение третьей модели с учётом признака "имя папы"  
    - оценка трёх моделей по метрикам R2, MSE, MAE, RMSE и выявление наилучшей модели  
    - рассчёт доверительного интервала    
    - с помощью лучшей модели прогнозирование удоя коров среди тех, которые фермер рассматривает к приобретению.    
6) Построение модели логистической регресии:  
    - построение модели по целевому признаку "вкус молока"  
    - оценка качества модели по трём метрикам: accuracy, recall, precision  
    - выявление и минимизация класса ошибки при присвоении объектам категории "вкусного молока"  
    - составление прогноза по вкусу молока коров среди тех, которые фермер рассматривает к приобретению.    
7) Итоговые выводы:  
    - отбор коров с вкусным молоком и удоем больше 6000 кг.  
    - составление рекомендаций

    
### Общий вывод
В ходе исследования были предприняты следующие действия:    
1) Изучение общей информации:  
    
Данные были загружены и представлены в трёх таблицах: ferma_main.csv, ferma_dad.csv, cow_buy.csv.  
В первой таблице 12 столбцов и 634 строк, во второй 2 столбца и 629 строк, в третей - 7 столбцов и 20 строк.    
Было замечено, что количество строк в таблицах ferma_main.csv и ferma_dad.csv не совпадают.   
На этапе предобработки данных это исправлено.    
Характеристики в столбцах совпадают с заявленными в техническом задании.    
Названия столбцов были приведены к нижнему регистру.  
Также названия были укорочены для удобства обращения к конкрентным столбцам.    

2) Предобработка данных:      
    
Были заменены значения в столбцах "вкус" и "возраст" на бинарные 0 и 1 для простоты расчётов.  
Были удалены явные и неявные дубликаты (ошибки при написании данных).  
Благодаря этому количеству строк в первых двух таблицах совпадает.   
Вся текстовая информация приведена к нижнему регистру.  
Пропуски не были обнаружены.         

3) Исследовтельский анализ данных:    
    
Был проведён статистический анализ таблицы ferma_main. Были выявлены следующие осоебнности:
- Коров старше 2-ух лет 83%, остальные - моложе 2-ух лет
- 59% молока - вкусное
- 51% пап-быков породы айдал, остальные 49% - соверин
- 59% коров породы Вис Бик Айдиал, остальные 41% - породы РефлешнСоверинг
- Распределению по проценту белка имеет нормальный вид, среднее и медианное значение близки. Замечено небольшое количество выборосов.
- в столбце "удой" наблюдается один очевидный выброс, который оказывает сильное влияние на наблюдение. Среднее (6125) и медианное (6133) близки.
5% значение меньше 5359, 99% значений меньше 7138. Распределение имеет нормальный вид со скосом вправо, превалируют низкие показатели.
- Распределение по ЭКЕ имеет нормальный вид со скосом влево, превалируют высокие показатели. Среднее (14.5438) и медианное (14.7) значения близки.
- Распределение по количеству сырого протеина смещено вправо, превалируют низкие показатели.
Среднее (1923.36) и медианное(1888) значения близки.
- Распределение по СПО сильно спещено вправо, превалируют высокие показатели.
Среднее (0.913) и медианное(0.93) сильно различаются.
- Распределение по проценту жирности сильно смещено влево. Среднее (3.603) и медианное(3.65) сильно различаются. Замечено большое количество выбросов в меньшую сторону.  
  
4) Корреляционный анализ данных:   
    
- Сильнее всего показатели удоя корреклируют с параметрами "эке", "сырой_проетин", "спо", "жирность". С показателем белка почти не коррелирует.  
- Взаимосвязь удоя с ЭКЕ нелинейная. Нужно ввести квадрат этого параметра.  
- Мультиколлинеарность между признаками не наблюдается    
- Взаимосвязь удоя и СПО нелинейна, СПО можно перевести в категориальный вид.    
- Очевидно, что сильнее всего на количество производимого молока влияет прежде всего качество потребляемой пищи и условия пастбищ. Из количественных показателей это "эке", "спо" и "Сырой протеин".   
    Из категориальных : "порода", "возраст", "порода папы", "тип пастбища" и "имя папы". Будем учитывать это при построении моделей прогнозирования удоя.  
- Исключаем из рассмотрения показатели качества молока : "белок" и "жирность"         

5) Построение линейных моделей для прогнозирования удоя:  
    
- В данной части работы были разработаны три модели линейной регрессии.  
- В качестве целевых численных параметров были взяты "эке" и "спо" и "сырой_протеин", отражающие качество питания коров.  
- Категориальными признаками были взяты все остальные параметры, кроме "вкус", "жирность" и "белок" - они отражают качество молока.  
- Качество каждой из них было оценено с помощью метрик R2, MAE, MSE, RMSE.  
- Модель 1:  
R2  = 0.819
MAE  = 181
MSE = 49615
RMSE = 223     
- Модель 2:  
R2  = 0.844
MAE = 164
MSE = 42834
RMSE = 207     
- Модель 3:  
R2  = 0.863
MAE  = 153
MSE = 37651
RMSE = 194       
- Была выявлена наилучшая модель - третья имеет показатель R2 ближайший к еденице, а показатели MAE, MSE, RMSE ближе к нулю.   
- Резултат показывает нам правильность действий в ходе адаптации данных при построении третьей модели:  
    - была устранена нелинейность зависимости целевого и выходных данных (возведением в квадрат показателя "эке", перевод признака "спо" в категориальный)    
    - добавлена категория "имя_папы"  
- Доверительный интервал удоя был взят в границах от 5 до 95% всех показателей и составил 5341 - 6697 (кг).   
- Было составлено предсказание по третьей модели на удой для коров, рассматриваемых к приобретению. Данные добавлены в таблицу.  
- Все предсказанные значения попали внутрь доверительного интервала, что отражает корректность работы модели.    

6) Построение логистической модели для прогнозирования вкуса молока.    

В данной части исследования было сконструирована модель логистической регрессии.  
В качестве коррелирующих признаков были приняты те, которые отражают условия содержания, возраст, качество питания, качество молока и происхождение коров.  
Было определено предсказание по вкусу молока.  
Был выбран порог причисления к классу в 0.83, который бы обеспечил нам требуемую максимальную точность причисления молока к категории "вкусного".  
Модель не выдала вариантов коров с вкусным молоком.    

В качестве альтернативной модели прогнозирования была применена модель с порогом в 0.78.  
Она даёт минимальную вариативность к выбору покупки коров: моделью предсказано вкусное молоко у трёх коров с индексами 0, 11, 13.  
    
7) Вывод и предложение:  
    
Сопоставив два прогноза - по удою и вкусу - и строго следуя требованиям фермерм, невозможно предложить ни одну из рассматриваемых коров.  
Тем не менее, если потребность в расширении производства критическая, по альтернативной модели прогнозирования с точностью на 5% ниже, прогноз предлагает к приобретению корову с индексом 0 и удоем 6125 кг.  

    

