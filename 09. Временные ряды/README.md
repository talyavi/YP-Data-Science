# Прогнозирование количества заказов такси
#### Описание исследования
Компания "Чётенькое такси" заказала разработку модели прогнозирования количества заказов такси с 
целью регулирования количества привлекаемых к работе водителей в часы-пик.  
Для формирования модели были предоставлены исторические данные о заказах такси в аэропортах.  

План моей работы:   
    1) Загрузка данных, их ресэмплирование    
    2) Анализ данных    
    3) Обучение моделей с различными гиперпараметрами: LinearRegression, LGBMRegressor и CatBoostRegressor   
    4) Проверка лучшей модели на тестовой выборке  
    5) Итоги работы  

#### Общие выводы    
В ходе работы мной были предприняты следующие шаги:
1) Данные были загружены - в исходной таблице 26496 записей с данными о заказах такси, разбитые по 10 минут.  
Данные были ресемплированы по часу - в итоговой таблице стало 4416 записей.
2) Анализ данных: были построены графики тренда, сезонности и остатоков. 
    При рассмотрении графиков наблюдаем, что:
- Тренд за период всех наблюдений иллюстрирует тенденцию к увеличению количества вызовов    
- Наблюдается явная сезонность по наблюдениям за последний месяц, что сообщает о стационарости процесса    
- По остатоком наблюдются периодические скачки, которыми отмечается время в ночь с воскресенья на понедельник (конец выходных)   
3) На тренировочной выборке были обучены 3 модели с различными гиперпараметрами: LinearRegression, LGBMRegressor и CatBoostRegressor    
    Для принятия оценки качества предсказания моделей для каждой из них была вычеслена метрика RMSE и пременено условие RMSE < 48  
    Получили следующие показатели:   
        - LinearRegression = 28.97  
        - LGBMRegressor = 12.54    
        - CatBoostRegressor = 16.20    
Все три подходят по критерию из технического задания.  Но наилучшую метрику показала модель LGBMRegressor 
с гиперпараметрами 'learning_rate': 0.1, 'max_depth': 20, 'n_estimators': 100. 

4) Модель LGBMRegressor была протестирована на тестовой выборке. Метрика RMSE = 43.3.  
Были построены графики для демонстрации сводимости предсказаний модели к исходным тестовым данным.     
По графику видно, что предсказания модели близки к реальным значениям.  
Тем не менее, заметны значительное различия этих показателей:  
    1) Модель не оказалась способной предсказать периоды аномального пика заказов такси (конец выходных дней)    
    2) Скользящее среднее демонстрирует рост с течением времени, что сообщает о растущей разности предсказаний и исходных данных 
    3) Также с течением времени стали заметна рост скользящего стандартного отклонения. Скачки этого показателя сообщают о большом разбросе данных в этот промежуток времени. 

5) Итоги работы:
При обзоре работы модели, можно сказать, что она хорошо справляется с ежедневно повторяющимися явлениями, но не способна предсказать аномальный спрос.  
Можем предположить, что способность модели корректно предсказывать количество заказов связанно с постоянно возрастающим в течение года спросом на такси.   
Для того, чтобы модель могла лучше прогнозировать часы пик, необходимо количество данных, собранных за больший период, чем полгода.  
